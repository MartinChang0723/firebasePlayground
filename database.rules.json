{
  "rules": {
    ".read": false,
    ".write": false,
    "user": {
      ".read": false,
      ".write": false,
      "$uid": {
        ".read": "auth.uid == $uid",
        ".write": "auth.uid == $uid"
      }
    },
    "firmware": {
      ".indexOn": ["customCategoryVersion"],
      ".read": "
      root.child('user').child(auth.uid).child('role').val() === 'admin' ||
      root.child('user').child(auth.uid).child('role').val() === 'vendor' ||
      (
        query.orderByChild == 'custom' && (
          query.equalTo == root.child('user').child(auth.uid).child('custom').val() ||
          (
            query.startAt == root.child('user').child(auth.uid).child('custom').val() &&
            query.endAt == root.child('user').child(auth.uid).child('custom').val()
          )
        )
      )
      ",
      ".write": "root.child('user').child(auth.uid).child('role').val() === 'admin' ||
      query.orderByChild == 'custom' && query.equalTo == root.child('user').child(auth.uid).child('custom').val()
      ",
      ".indexOn": ["custom"],
      "$fid": {
        "updatedAt": {
          ".write": "root.child('user').child(auth.uid).child('role').val() === 'vendor'"
        },
        "feature": {
          ".write": "root.child('user').child(auth.uid).child('role').val() === 'vendor'"
        },
        "bugFixed": {
          ".write": "root.child('user').child(auth.uid).child('role').val() === 'vendor'"
        },
        "modelTxt": {
          ".write": "root.child('user').child(auth.uid).child('role').val() === 'vendor'"
        }
      }
    },
    "product": {
      ".read": "
      root.child('user').child(auth.uid).child('role').val() === 'admin' ||
      root.child('user').child(auth.uid).child('role').val() === 'vendor' ||
      query.orderByChild != null && query.equalTo == root.child('user').child(auth.uid).child('custom').val()
      ",
      ".write": false,
      ".indexOn": [
        "custom/lantech_21net",
        "custom/lantech_acrobel",
        "custom/lantech_canada",
        "custom/lantech_germany",
        "custom/lantech_hytec",
        "custom/lantech_lantech",
        "custom/lantech_lgu+",
        "custom/lantech_ltdp",
        "custom/lantech_optigo",
        "custom/lantech_pandacom",
        "custom/lantech_ruf",
        "custom/lantech_tekdis",
        "custom/lantech_teslakom",
        "custom/lantech_trafsys",
        "custom/lantech_turkey"
      ],
      "$pid": {
        ".write": "root.child('user').child(auth.uid).child('role').val() === 'admin'"
      }
    },
    "mib": {
      ".read": false,
      ".write": false,
      "download": {
        ".read": "false",
        ".write": "false",
        "$did": {
          ".read": "
          root.child('user').child(auth.uid).child('role').val() === 'admin' ||
          root.child('user').child(auth.uid).child('role').val() === 'vendor' ||
          $did.contains(root.child('user').child(auth.uid).child('custom').val())
          ",
          ".write": "false",
        }
      },
      "entry": {
        ".read": "
        root.child('user').child(auth.uid).child('role').val() === 'admin' ||
        root.child('user').child(auth.uid).child('role').val() === 'vendor' ||
        (
          query.orderByChild == 'custom' && (
            query.equalTo == root.child('user').child(auth.uid).child('custom').val() ||
            (
              query.startAt == root.child('user').child(auth.uid).child('custom').val() &&
              query.endAt == root.child('user').child(auth.uid).child('custom').val()
            )
          )
        )
        ",
        ".write": false,
        ".indexOn": ["custom", "custom_version"],
        "$eid": {
          ".read": "$eid.contains(root.child('user').child(auth.uid).child('custom').val())",
          ".write": "root.child('user').child(auth.uid).child('role').val() === 'admin'",
          "feature": {
            ".write": "root.child('user').child(auth.uid).child('role').val() === 'vendor'"
          },
          "updatedAt": {
            ".write": "root.child('user').child(auth.uid).child('role').val() === 'vendor'"
          }
        }
      }
    }
  }
}